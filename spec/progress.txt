# Ralph Progress Log

This file tracks progress, learnings, and patterns discovered across Ralph iterations.
Each iteration should APPEND to this file, never overwrite.

---

## Codebase Patterns

<!--
  Add patterns discovered about this codebase here.
  Future iterations read this section FIRST.
-->

- **Component Style:** React functional components with TypeScript
- **Styling:** Tailwind CSS utility classes
- **State Management:** React useState/useContext (no external state library)
- **File Naming:** PascalCase for components, camelCase for utilities
- **Exports:** Use barrel files (index.ts) for clean imports
- **Imports:** Prefer direct imports for tree-shakable libraries (e.g. lucide-react)
- **Performance:** Use useMemo/useCallback for expensive ops and handlers passed to children

---

## Gotchas & Warnings

<!--
  Add things that caused issues or took extra time.
  Helps future iterations avoid the same mistakes.
-->

- Remember to run `npm run typecheck` before committing
- Tailwind dynamic classes need to be in safelist or use full class names
- This project uses path aliases: `@/` maps to `src/`

---

## Progress Entries

<!--
  Each iteration appends a new entry below.
  Format:

  ## YYYY-MM-DD HH:MM - [Task ID]
  - What was implemented
  - Files changed
  - Any issues encountered
  - Patterns or learnings discovered
-->

## 2026-01-25 - US-CAL-01
- Added ViewMode type: 'list' | 'calendar' to src/types/index.ts
- Files changed: src/types/index.ts
- No issues encountered
- Simple foundational type for calendar feature toggle

## 2026-01-25 - US-CAL-02
- Created ViewModeToggle component with List/Calendar icons
- Files changed: src/components/ViewModeToggle.tsx, src/components/index.ts
- Props: viewMode: ViewMode, onChange: (mode: ViewMode) => void
- Styled to match FilterTabs with purple highlight for active state
- Uses direct lucide-react ESM imports (List, Calendar icons)
- Component ready to be wired into MainLayout (US-CAL-03)

## 2026-01-25 - US-CAL-03
- Added viewMode state to MainLayout with useState<ViewMode>('list')
- Rendered ViewModeToggle between FilterTabs and TaskInput
- Files changed: src/components/MainLayout.tsx
- Imported ViewModeToggle component and ViewMode type
- Toggle renders and switches between List/Calendar modes
- Next step: US-CAL-04 (Calendar utilities) or later stories to wire CalendarView

## 2026-01-25 - US-CAL-04
- Created src/utils/calendarUtils.ts with CalendarDay interface and utility functions
- Implemented generateCalendarDays(month, tasks) returning 42 CalendarDay objects (6 weeks)
- Implemented getTasksForDate(tasks, date) filtering tasks by due date
- Added hasOverdueTasks helper for overdue indicator support
- Files changed: src/utils/calendarUtils.ts, src/utils/calendarUtils.test.ts
- 16 unit tests covering all utilities
- Gotcha: Use `new Date(year, month, day)` in tests to avoid timezone issues with ISO strings

## 2026-01-25 - US-CAL-05
- Created CalendarHeader component with month/year display and navigation
- Files changed: src/components/calendar/CalendarHeader.tsx, src/components/calendar/index.ts
- Props: currentMonth, onPrevMonth, onNextMonth, onToday
- Today button disabled when viewing current month (uses date-fns isSameMonth)
- Uses ChevronLeft/ChevronRight icons from lucide-react
- Pattern: Created calendar/ subdirectory with barrel file for calendar components
- Ready to be composed into CalendarView (US-CAL-09)

## 2026-01-25 - US-CAL-06
- Created CalendarGrid component with 7-column CSS grid layout
- Files changed: src/components/calendar/CalendarGrid.tsx, src/components/calendar/index.ts
- Props: days (CalendarDay[]), onDayClick (optional callback)
- Features: day-of-week headers (Sun-Sat), 6 weeks of cells, today highlight with purple ring
- Task count badges shown on days with tasks, overdue days get red tint
- Uses gap-px trick with rounded overflow for clean grid borders
- Ready to be composed with CalendarDay items (US-CAL-07) and CalendarView (US-CAL-09)

## 2026-01-25 - US-CAL-07
- Created CalendarDay component for individual day cell rendering
- Files changed: src/components/calendar/CalendarDay.tsx, src/components/calendar/index.ts
- Props: day (CalendarDay), onClick (optional callback)
- Features: date number (dimmed if not current month), today highlight with purple ring
- Task count badge, priority color dots (red/amber/gray for high/medium/low)
- Max 2 task previews with truncated titles, "+N more" for remaining
- Strikethrough for completed tasks, overdue indicator (red tint)
- Uses getPriorityColor helper matching TaskRow pattern
- Ready to replace inline rendering in CalendarGrid or for direct use in CalendarView

## 2026-01-25 - US-CAL-08
- Created CalendarTaskItem component for compact task previews in calendar cells
- Files changed: src/components/calendar/CalendarTaskItem.tsx, src/components/calendar/index.ts, src/components/calendar/CalendarDay.tsx
- Props: task (Task)
- Features: priority dot (red/amber/gray) + truncated title, strikethrough for completed
- Extracted from inline rendering in CalendarDay for reusability
- CalendarDay now imports and uses CalendarTaskItem

## 2026-01-25 - US-CAL-09
- Created CalendarView container component assembling all calendar pieces
- Files changed: src/components/calendar/CalendarView.tsx, src/components/calendar/index.ts
- Props: tasks (Task[])
- Manages currentMonth state with useState, startOfMonth for initial value
- Month navigation: handlePrevMonth/handleNextMonth using date-fns addMonths/subMonths
- Today button resets to current month via startOfMonth(new Date())
- Uses useMemo to memoize generateCalendarDays for performance
- Composes CalendarHeader + CalendarDay in a 7-column grid
- handleDayClick placeholder ready for US-CAL-12 modal integration
- Ready to be wired into MainLayout (US-CAL-10)

## 2026-01-25 - US-CAL-10
- Wired CalendarView into MainLayout with conditional rendering based on viewMode
- Files changed: src/components/MainLayout.tsx, src/components/index.ts
- Added CalendarView import from ./calendar barrel file
- Added useMemo-wrapped calendarTasks filtering tasks with dueDate for calendar
- Conditional render: viewMode === 'calendar' shows CalendarView, else list view
- Exported all calendar components from main index.ts barrel file
- View toggle now fully functional: List shows task groups, Calendar shows monthly grid

## 2026-01-25 - US-CAL-11
- Created DayTasksModal component for displaying all tasks on a selected date
- Files changed: src/components/calendar/DayTasksModal.tsx, src/components/calendar/index.ts
- Props: isOpen, date, tasks, onClose, onToggle, onUpdate, onDelete
- Uses existing TaskRow component for task display
- Escape key closes modal via useEffect keydown listener
- Backdrop click also closes modal
- Follows KeyboardShortcutsModal pattern for styling consistency
- Displays formatted date header (e.g., "Saturday, January 25, 2026")
- Empty state message when no tasks for the day
- Ready to be wired into CalendarView with day click handler (US-CAL-12)

## 2026-01-25 - US-CAL-12
- Added day click handler to open DayTasksModal from CalendarView
- Files changed: src/components/calendar/CalendarView.tsx, src/components/MainLayout.tsx
- Added selectedDate state (Date | null) to CalendarView
- handleDayClick sets selectedDate, handleCloseModal clears it
- selectedDateTasks computed via useMemo with getTasksForDate
- CalendarView props extended with onToggle, onUpdate, onDelete for task actions
- MainLayout passes handleToggle, handleUpdate, handleDelete to CalendarView
- Modal renders conditionally when selectedDate is non-null
- All task operations (toggle complete, edit, delete) work within modal

